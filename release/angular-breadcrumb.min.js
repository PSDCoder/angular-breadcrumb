/*! angular-breadcrumb - v0.4.5
* http://ncuillery.github.io/angular-breadcrumb
* Copyright (c) 2015 Nicolas Cuillery; Licensed MIT */
!function(a,b,c){"use strict";function d(a,c){return b.equals(a.length,c.length)?a>c:a.length>c.length}function e(a){var b=[],c={};for(var d in a.$current.views)a.$current.views.hasOwnProperty(d)&&b.push(d);return b.forEach(function(b){c[b]=a.$current.locals[b].$scope}),c}function f(a){var b=a.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/);if(!b||4!==b.length)throw new Error("Invalid state ref '"+a+"'");return{state:b[1],paramExpr:b[3]||null}}function g(){var a={prefixStateName:null,template:"bootstrap3",templateUrl:null,includeAbstract:!1};this.setOptions=function(c){b.extend(a,c)},this.$get=["$state","$stateParams","$rootScope",function(b,e,g){var h=g;g.$on("$viewContentLoaded",function(a){d(a.targetScope.$id,h.$id)&&(h=a.targetScope)});var i=function(a){var b=a.parent||(/^(.+)\.[^.]+$/.exec(a.name)||[])[1],c="object"==typeof b;return c?b.name:b},j=function(c,d){for(var g,i,j=f(d),k=!1,l=!1,m=0,n=c.length;n>m;m+=1)if(c[m].name===j.state)return;g=b.get(j.state),g.ncyBreadcrumb&&(g.ncyBreadcrumb.force&&(k=!0),g.ncyBreadcrumb.skip&&(l=!0)),g["abstract"]&&!a.includeAbstract&&!k||l||(j.paramExpr&&(i=h.$eval(j.paramExpr)),g.ncyBreadcrumbLink=b.href(j.state,i||e||{}),c.unshift(g))},k=function(a){var c=f(a),d=b.get(c.state);if(d.ncyBreadcrumb&&d.ncyBreadcrumb.parent){var e="function"==typeof d.ncyBreadcrumb.parent,g=e?d.ncyBreadcrumb.parent(h):d.ncyBreadcrumb.parent;if(g)return g}return i(d)};return{getTemplate:function(b){return a.templateUrl?null:b[a.template]?b[a.template]:a.template},getTemplateUrl:function(){return a.templateUrl},getStatesChain:function(c){for(var d=[],e=b.$current.self.name;e;e=k(e))if(j(d,e),c&&d.length)return d;return a.prefixStateName&&j(d,a.prefixStateName),d},getLastStep:function(){var a=this.getStatesChain(!0);return a.length?a[0]:c},$getLastViewScope:function(){return h}}}]}function h(a,c,d,f,g){var h={bootstrap2:'<ul class="breadcrumb"><li ng-repeat="step in steps" ng-switch="$last || !!step.abstract" ng-class="{active: $last}"><a ng-switch-when="false" href="{{step.ncyBreadcrumbLink}}">{{step.ncyBreadcrumbLabel}}</a><span ng-switch-when="true">{{step.ncyBreadcrumbLabel}}</span><span class="divider" ng-hide="$last">/</span></li></ul>',bootstrap3:'<ol class="breadcrumb"><li ng-repeat="step in steps" ng-class="{active: $last}" ng-switch="$last || !!step.abstract"><a ng-switch-when="false" href="{{step.ncyBreadcrumbLink}}">{{step.ncyBreadcrumbLabel}}</a><span ng-switch-when="true">{{step.ncyBreadcrumbLabel}}</span></li></ol>'};return{restrict:"AE",replace:!0,scope:{},template:c.getTemplate(h),templateUrl:c.getTemplateUrl(),link:{post:function(h){var i=[],j=function(){m(i),i=[];var d=c.$getLastViewScope();h.steps=c.getStatesChain(),b.forEach(h.steps,function(c){if(c.ncyBreadcrumb&&c.ncyBreadcrumb.label)if(b.isFunction(c.ncyBreadcrumb.label))c.ncyBreadcrumbLabel=f.invoke(c.ncyBreadcrumb.label,null,{$scope:h,$viewScopes:e(g)});else{var j=a(c.ncyBreadcrumb.label);c.ncyBreadcrumbLabel=j(d),l(i,j,d,c)}else c.ncyBreadcrumbLabel=c.name})};d.$on("$viewContentLoaded",function(){j()}),j()}}}}function i(a,c,d,f,g){return{restrict:"A",scope:{},template:"{{ncyBreadcrumbLabel}}",compile:function(h,i){var j=h.attr(i.$attr.ncyBreadcrumbLast);return j&&h.html(j),{post:function(h){var i=[],j=function(){m(i),i=[];var d=c.$getLastViewScope(),j=c.getLastStep();if(j)if(h.ncyBreadcrumbLink=j.ncyBreadcrumbLink,j.ncyBreadcrumb&&j.ncyBreadcrumb.label)if(b.isFunction(j.ncyBreadcrumb.label))h.ncyBreadcrumbLabel=f.invoke(j.ncyBreadcrumb.label,null,{$scope:h,$viewScopes:e(g)});else{var k=a(j.ncyBreadcrumb.label);h.ncyBreadcrumbLabel=k(d),l(i,k,d,h)}else h.ncyBreadcrumbLabel=j.name};d.$on("$viewContentLoaded",function(){j()}),j()}}}}}function j(a,c,d,f,g){return{restrict:"A",scope:{},template:"{{ncyBreadcrumbChain}}",compile:function(h,i){var j=h.attr(i.$attr.ncyBreadcrumbText);j&&h.html(j);var l=h.attr(i.$attr.ncyBreadcrumbTextSeparator)||" / ";return{post:function(h){var i=[],j=function(a,c,d){b.forEach(k(c),function(b){var c=d.$watch(b,function(a,b){a!==b&&n()});a.push(c)})},n=function(){m(i),i=[];var d=c.$getLastViewScope(),k=c.getStatesChain(),n=[];b.forEach(k,function(c){if(c.ncyBreadcrumb&&c.ncyBreadcrumb.label)if(b.isFunction(c.ncyBreadcrumb.label))n.push(f.invoke(c.ncyBreadcrumb.label,null,{$scope:h,$viewScopes:e(g)}));else{var k=a(c.ncyBreadcrumb.label);n.push(k(d)),j(i,k,d)}else n.push(c.name)}),h.ncyBreadcrumbChain=n.join(l)};d.$on("$viewContentLoaded",function(){n()}),n()}}}}}var k=function(a){if(a.expressions)return a.expressions;var c=[];return b.forEach(a.parts,function(a){b.isFunction(a)&&c.push(a.exp)}),c},l=function(a,c,d,e){b.forEach(k(c),function(b){var f=d.$watch(b,function(){e.ncyBreadcrumbLabel=c(d)});a.push(f)})},m=function(a){b.forEach(a,function(a){a()})};h.$inject=["$interpolate","$breadcrumb","$rootScope","$injector","$state"],i.$inject=["$interpolate","$breadcrumb","$rootScope","$injector","$state"],j.$inject=["$interpolate","$breadcrumb","$rootScope","$injector","$state"],b.module("ncy-angular-breadcrumb",["ui.router.state"]).provider("$breadcrumb",g).directive("ncyBreadcrumb",h).directive("ncyBreadcrumbLast",i).directive("ncyBreadcrumbText",j)}(window,window.angular);